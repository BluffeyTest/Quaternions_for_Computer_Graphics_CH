\documentclass[10pt,b5paper,twoside]{book}

%\usepackage{algorithm}  
%\usepackage{algorithmic}  
\usepackage{wallpaper} %使用wallpaper宏包

\usepackage[final]{pdfpages} %插入整页pdf
\usepackage[T1]{fontenc}
\usepackage{CJKutf8}
%\usepackage{CJK}
\usepackage[utf8]{inputenc}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{amssymb}
\usepackage{subfigure}
\usepackage{graphicx}
\usepackage{grffile}
\usepackage{epstopdf}%支持eps格式图
\usepackage[centerlast]{caption}
% \counterwithin{figure}{section} %图按照章节编号
\counterwithin{figure}{chapter} %图按照章节编号
% \counterwithin{equation}{section} %公式按照章节编号
\counterwithin{equation}{chapter} %公式按照章节编号
\counterwithin{table}{section} %表按照章节编号
%\usepackage{fourier}
\usepackage[left=2cm,right=2cm,top=2cm,bottom=2cm]{geometry}

\usepackage[export]{adjustbox}
\graphicspath{ {./images/} }

%设置缩进
\usepackage{indentfirst} 
\setlength{\parindent}{2em}

\usepackage{amsthm}
% 中文定理环境
\theoremstyle{plain}
% \indent 为了段前空两格
% \newtheorem{theorem}{\indent 定理}[section]
\newtheorem{theorem}{\indent 定理}[chapter]
\newtheorem{lemma}[theorem]{\indent 引理}
\newtheorem{proposition}[theorem]{\indent 命题}
\newtheorem{corollary}[theorem]{\indent 推论}
\newtheorem{definition}{\indent 定义}[section]
% \newtheorem{example}{\indent 例}[section]
% \newtheorem{example}{\indent 例}%[chapter]
\newtheorem{example}{\indent 例}%[chapter]
\newtheorem{remark}{\indent 注}[section]
\newenvironment{solution}{\begin{proof}[\indent\bf 解]}{\end{proof}}
% \renewcommand{\proofname}{\indent\bf 证明}


% % English theorem environment
% \newtheorem{theorem}{Theorem}[section]
% \newtheorem{lemma}[theorem]{Lemma}
% \newtheorem{proposition}[theorem]{Proposition}
% \newtheorem{corollary}[theorem]{Corollary}
% \newtheorem{definition}{Definition}[section]
% \newtheorem{remark}{Remark}[section]
% \newtheorem{example}{Example}[section]
% \newenvironment{solution}{\begin{proof}[Solution]}{\end{proof}}

% 附录
\usepackage[title]{appendix}

%设置行距
\linespread{1.4}

%设置章节显示
\usepackage[center]{titlesec}
%\titleformat{\chapter}
\definecolor{gray75}{gray}{0.75}
\newcommand{\hsp}{\hspace{20pt}}
\titleformat{\chapter}{\Huge\bfseries}{\begin{CJK}{UTF8}{gkai}第\,\thechapter\,章\hsp\textcolor{gray75}{|}\hsp\end{CJK}}{0pt}{\Huge\bfseries}

%% 重新定义章节字体，并同时更新例子编号
\newcommand{\chap}[1]{
	\begin{CJK}{UTF8}{gkai}\chapter{#1} \end{CJK} %更改字体
	\setcounter{example}{0} % 更改例子编号
}

\makeatletter %使\subsection中的内容左对齐
\renewcommand{\subsection}{\@startsection{subsection}{2}{0mm}
  {-\baselineskip}{0.5\baselineskip}{\bf\leftline}}
\renewcommand{\subsubsection}{\@startsection{subsubsection}{2}{0mm}
  {-\baselineskip}{0.5\baselineskip}{\bf\leftline}}

% 更改目录的章显示
\usepackage{titletoc}
% \titlecontents{chapter}[0pt]{\addvspace{1.5pt}\filright\bf}%
%                {\contentspush{第\,\thecontentslabel\,章\quad}}%
%                {}{\titlerule*[8pt]{.}\contentspage}
\titlecontents{chapter}[0pt]{\addvspace{1.5pt}\filright\bf}%
               {\contentspush{第\,\thecontentslabel\,章\quad}}%
               {}{\titlerule*[8pt]{.}\contentspage}
\setcounter{tocdepth}{2} %设置目录深度为只显示到section一级

% 更改页眉页脚为第几章形式
%\usepackage{fancyhdr}%导入fancyhdr包
%\pagestyle{fancy}
%\fancyhead{} % 初始化页眉
%\renewcommand{\chaptermark}[1]{\markboth{#1}{}}
\renewcommand{\chaptermark}[1]{\markboth{\begin{CJK}{UTF8}{gkai}第\,\thechapter\,章\, #1\end{CJK}}{}}
\renewcommand{\sectionmark}[1]{\markright{\thesection\, #1}}


%\fancyhead[LE]{\textsl{\rightmark}}
%\fancyhead[RO]{\textsl{\leftmark}}
%\renewcommand{\sectionmark}[1]{\markright{\thesection\,节\, #1}}
%\renewcommand{\chaptermark}[1]{\markright{第\,\thechapter\,章\, #1}{}}

%c++代码显示环境
\usepackage{listings}
\lstset{language=C++}

%算法伪代码环境
\usepackage[ruled,vlined]{algorithm2e}
%\usepackage[linesnumbered,lined,boxed,commentsnumbered]{algorithm2e}
%\usepackage{algorithm}
%\usepackage{algorithmic}

% 超链接设置及冲突解决
\usepackage{hyperref}
\hypersetup{unicode}
\hypersetup{colorlinks=true, linkcolor=blue, filecolor=magenta, urlcolor=cyan,}
\urlstyle{same}

% 使序和译序以及目录有书签
%\usepackage{lipsum}
%\usepackage{tocbibind}%为目录、参考文献和索引生成目录项
%\usepackage{bookmark}
%\hypersetup{CJKbookmarks=true}%让设置超链接后章节里面能写中文

%更改目录
\renewcommand{\contentsname}{目录}

% 更改算法显示为中文
\renewcommand{\algorithmcfname}{算法}

%更改图表的显示
\renewcommand{\figurename}{图}
\renewcommand{\tablename}{表}

\begin{document}
\begin{CJK}{UTF8}{gkai}

	\setcounter{page}{0}
	\pagenumbering{roman}
\begin{titlepage}
  \vspace*{1cm}
	\begin{center}
		{\Huge \textbf{计算机图形学中的四元数}\par}
		{\Large \textbf{Quaternion for Computer Graphics}\par}
		%{\Huge\raggedright 图形瑰宝\par}
  		%\noindent\hrulefill\par
  		\vspace*{1cm}
  		{\large\raggedleft John Vince  著\par}
  		{\large\raggedleft 郭飞  译\par}
  		
  		\vfill
  		{\Large 2023年\par}
  		%{\Large\raggedleft Institute\par}
	\end{center}
\end{titlepage} 

\thispagestyle{empty}
\mbox{}
\newpage
\thispagestyle{empty}
	\vspace*{5cm}
	\begin{center}
		\textit{谨以此书献给Heidi.} 
	\end{center}
\newpage
\thispagestyle{empty}
\clearpage
\mbox{}
\end{CJK}
%\begin{titlingpage}
%\maketitle
%\end{titlingpage}
%\includepdf{booktest (another copy).pdf}

%\newpage

%\maketitle

%\ThisCenterWallPaper{0.5}{./fig/cover.png}


\begin{CJK}{UTF8}{gbsn}
	
%\bookmark[page=1,level=0]{标题}
\newpage
\include{Preface}

\begin{CJK}{UTF8}{gkai}
\pdfbookmark{\contentsname}{Contents}
\tableofcontents
\end{CJK}
% \bookmark[dest=\HyperLocalCurrentHref, level=0]{目录}
%\pdfbookmark{目录}{contentsname}
%\bookmark[page=9,level=0]{目录}

\newpage
\setcounter{page}{0}
\pagenumbering{arabic}
\include{Introduction}
\include{Number_Sets_and_Algebra}
\include{Complex_Numbers}
\include{Complex_Plane}
\include{Quaternion_Algebra}
\include{3D_Rotation_Transforms}
\include{Quaternions_in_Space}
\include{Conclusion}
\include{Appendix_eigen}
\include{References}
%\include{num_pro}
%\include{mod_trans}



\clearpage
\end{CJK}
\end{document}